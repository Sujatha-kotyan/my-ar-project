<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>AR Test</title>

  <!-- Model Viewer -->
  <script type="module"
    src="https://unpkg.com/@google/model-viewer/dist/model-viewer.min.js">
  </script>

  <style>
    html, body {
      margin: 0;
      width: 100%;
      height: 100%;
      background: #000;
    }

    model-viewer {
      width: 100%;
      height: 100%;
      display: block;
    }
  </style>
</head>

<body>

  <model-viewer
    id="viewer"
    src="https://modelviewer.dev/shared-assets/models/Astronaut.glb"
    camera-controls
    auto-rotate
    animation-name="Idle"
    autoplay>
  </model-viewer>

<script>
  const viewer = document.getElementById("viewer");
  let spinInterval = null;

  viewer.addEventListener("load", () => {
    console.log("âœ… Model loaded and visible");
  });

  function reset() {
    if (spinInterval) {
      clearInterval(spinInterval);
      spinInterval = null;
    }
    viewer.cameraOrbit = "0deg 75deg 2.5m";
    viewer.fieldOfView = "45deg";
  }

  window.addEventListener("message", (event) => {
    console.log("ðŸ“© Received:", event.data);
    reset();

    switch (event.data) {

      case 1: // Idle
        break;

      case 2: // Jump (camera bounce)
        viewer.cameraOrbit = "0deg 60deg 2.5m";
        setTimeout(() => {
          viewer.cameraOrbit = "0deg 80deg 2.5m";
        }, 300);
        break;

      case 3: // Wave (small rotate)
        viewer.cameraOrbit = "20deg 75deg 2.5m";
        break;

      case 4: // Dance (spin)
        let angle = 0;
        spinInterval = setInterval(() => {
          angle += 3;
          viewer.cameraOrbit = `${angle}deg 75deg 2.5m`;
        }, 30);
        break;
    }
  });
</script>

</body>
</html>
