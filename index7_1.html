<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<title>Bubble Shooter â€“ Grid Base</title>

<style>
body {
  margin: 0;
  overflow: hidden;
  background: black;
}

.bubble {
  width: 36px;
  height: 36px;
  border-radius: 50%;
  position: absolute;
}

.blue  { background: radial-gradient(circle, #9cf, #38f); }
.red   { background: radial-gradient(circle, #f99, #c33); }
.green { background: radial-gradient(circle, #9f9, #2c7); }
</style>
</head>

<body>

<!-- Shooter -->
<div id="shooter" class="bubble blue"></div>

<script>
/* ===== CONFIG ===== */
const SIZE = 36;
const COLS = 8;
const CELL = SIZE + 4;
const TOP = 60;

const colors = ["blue", "red", "green"];
let board = [];

/* ===== SHOOTER ===== */
const shooter = document.getElementById("shooter");
shooter.style.left = (window.innerWidth / 2 - SIZE / 2) + "px";
shooter.style.top = (window.innerHeight - 70) + "px";

shooter.addEventListener("click", shootBubble);

/* ===== SHOOT ===== */
function shootBubble() {
  const bubble = document.createElement("div");
  const color = colors[Math.floor(Math.random() * colors.length)];

  bubble.className = `bubble ${color}`;
  bubble.dataset.color = color;
  document.body.appendChild(bubble);

  let x = shooter.offsetLeft;
  let y = shooter.offsetTop;

  bubble.style.left = x + "px";
  bubble.style.top = y + "px";

  function move() {
    y -= 8;
    bubble.style.top = y + "px";

    // Hit ceiling or another bubble
    if (y <= TOP || hitBubble(bubble)) {
      lockBubble(bubble);
      return;
    }

    requestAnimationFrame(move);
  }

  move();
}

/* ===== COLLISION ===== */
function hitBubble(bubble) {
  return board.some(b => isColliding(bubble, b.el));
}

/* ===== LOCK TO GRID ===== */
function lockBubble(bubble) {
  const col = Math.floor(bubble.offsetLeft / CELL);
  const row = Math.floor((bubble.offsetTop - TOP) / CELL);

  const x = col * CELL + 10;
  const y = TOP + row * CELL;

  bubble.style.left = x + "px";
  bubble.style.top = y + "px";

  board.push({ el: bubble, row, col, color: bubble.dataset.color });

  console.log("ðŸ§© Bubble locked:", bubble.dataset.color);
}

/* ===== COLLISION CHECK ===== */
function isColliding(a, b) {
  const r1 = a.getBoundingClientRect();
  const r2 = b.getBoundingClientRect();

  return !(
    r1.right < r2.left ||
    r1.left > r2.right ||
    r1.bottom < r2.top ||
    r1.top > r2.bottom
  );
}
</script>

</body>
</html>
